/*!
 * w-docx-2-pdf v1.0.0
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("process"),require("child_process"),require("fs")):"function"==typeof define&&define.amd?define(["path","process","child_process","fs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-docx-2-pdf"]=e(t.path,t.process,t.child_process,t.fs)}(this,function(t,e,r,n){"use strict";var o=/\s/;var i=/^\s+/;function u(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&o.test(t.charAt(e)););return e}(t)+1).replace(i,""):t}function c(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var a="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,f=a||s||Function("return this")(),l=f.Symbol,p=Object.prototype,h=p.hasOwnProperty,d=p.toString,y=l?l.toStringTag:void 0;var v=Object.prototype.toString;var b=l?l.toStringTag:void 0;function g(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":b&&b in Object(t)?function(t){var e=h.call(t,y),r=t[y];try{t[y]=void 0;var n=!0}catch(t){}var o=d.call(t);return n&&(e?t[y]=r:delete t[y]),o}(t):function(t){return v.call(t)}(t)}function _(t){return null!=t&&"object"==typeof t}function j(t){return"symbol"==typeof t||_(t)&&"[object Symbol]"==g(t)}var w=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,O=/^0o[0-7]+$/i,x=parseInt;function S(t){if("number"==typeof t)return t;if(j(t))return NaN;if(c(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=c(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=u(t);var r=m.test(t);return r||O.test(t)?x(t.slice(2),r?2:8):w.test(t)?NaN:+t}var A=1/0;function z(t){return t?(t=S(t))===A||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function $(t){var e=z(t),r=e%1;return e==e?r?e-r:e:0}function B(t){return"[object String]"===Object.prototype.toString.call(t)}function P(t){return!(!B(t)||""===t)}function k(t){return t!=t}function F(t){let e=!1;if(P(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(k(t))return!1;e=!0}return e}function R(t){if(!F(t))return 0;return z(t)}function C(t){return!!F(t)&&(t=R(t),"number"==typeof(e=t)&&e==$(e));var e}var E=Array.isArray,M=l?l.prototype:void 0,T=M?M.toString:void 0;function I(t){if("string"==typeof t)return t;if(E(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,I)+"";if(j(t))return T?T.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function N(t){return null==t?"":I(t)}var U=f.isFinite,D=Math.min;var H,L=(H=Math["round"],function(t,e){if(t=S(t),(e=null==e?0:D($(e),292))&&U(t)){var r=(N(t)+"e").split("e");return+((r=(N(H(r[0]+"e"+(+r[1]+e)))+"e").split("e"))[0]+"e"+(+r[1]-e))}return H(t)});function q(t){if(!F(t))return 0;t=R(t);let e=L(t);return"0"===String(e)?0:e}let V="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),W=V.length;function G(t=32){let e=[];var r;t=C(r=t)&&q(r)>0?q(t):32;for(let r=0;r<t;r++)e[r]=V[0|Math.random()*W];return e.join("")}var J="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function K(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Q(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){if(this instanceof t){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(e,r))}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}var X={exports:{}};var Y,Z={exports:{}},tt=Q(Object.freeze({__proto__:null,default:{}}));function et(){return Y||(Y=1,function(t){var e;t.exports=(e=e||function(t,e){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==J&&J.crypto&&(r=J.crypto),!r)try{r=tt}catch(t){}var n=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var r;return t.prototype=e,r=new t,t.prototype=null,r}}(),i={},u=i.lib={},c=u.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},a=u.WordArray=c.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||f).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes,o=t.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var u=r[i>>>2]>>>24-i%4*8&255;e[n+i>>>2]|=u<<24-(n+i)%4*8}else for(var c=0;c<o;c+=4)e[n+c>>>2]=r[c>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4)e.push(n());return new a.init(e,t)}}),s=i.enc={},f=s.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],o=0;o<r;o++){var i=e[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new a.init(r,e/2)}},l=s.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],o=0;o<r;o++){var i=e[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new a.init(r,e)}},p=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r,n=this._data,o=n.words,i=n.sigBytes,u=this.blockSize,c=i/(4*u),s=(c=e?t.ceil(c):t.max((0|c)-this._minBufferSize,0))*u,f=t.min(4*s,i);if(s){for(var l=0;l<s;l+=u)this._doProcessBlock(o,l);r=o.splice(0,s),n.sigBytes-=f}return new a.init(r,f)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});u.Hasher=h.extend({cfg:c.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new d.HMAC.init(t,r).finalize(e)}}});var d=i.algo={};return i}(Math),e)}(Z)),Z.exports}!function(t){t.exports=et().enc.Utf8}(X);var rt=K(X.exports),nt={exports:{}};!function(t){var e;t.exports=(e=et(),function(){var t=e,r=t.lib.WordArray;function n(t,e,n){for(var o=[],i=0,u=0;u<e;u++)if(u%4){var c=n[t.charCodeAt(u-1)]<<u%4*2|n[t.charCodeAt(u)]>>>6-u%4*2;o[i>>>2]|=c<<24-i%4*8,i++}return r.create(o,i)}t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,n=this._map;t.clamp();for(var o=[],i=0;i<r;i+=3)for(var u=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,c=0;c<4&&i+.75*c<r;c++)o.push(n.charAt(u>>>6*(3-c)&63));var a=n.charAt(64);if(a)for(;o.length%4;)o.push(a);return o.join("")},parse:function(t){var e=t.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var u=r.charAt(64);if(u){var c=t.indexOf(u);-1!==c&&(e=c)}return n(t,e,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64)}(nt);var ot=K(nt.exports);var it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ut=/^\w*$/;function ct(t){if(!c(t))return!1;var e=g(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var at,st=f["__core-js_shared__"],ft=(at=/[^.]+$/.exec(st&&st.keys&&st.keys.IE_PROTO||""))?"Symbol(src)_1."+at:"";var lt=Function.prototype.toString;function pt(t){if(null!=t){try{return lt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var ht=/^\[object .+?Constructor\]$/,dt=Function.prototype,yt=Object.prototype,vt=dt.toString,bt=yt.hasOwnProperty,gt=RegExp("^"+vt.call(bt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _t(t){return!(!c(t)||function(t){return!!ft&&ft in t}(t))&&(ct(t)?gt:ht).test(pt(t))}function jt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return _t(r)?r:void 0}var wt=jt(Object,"create");var mt=Object.prototype.hasOwnProperty;var Ot=Object.prototype.hasOwnProperty;function xt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t,e){return t===e||t!=t&&e!=e}function At(t,e){for(var r=t.length;r--;)if(St(t[r][0],e))return r;return-1}xt.prototype.clear=function(){this.__data__=wt?wt(null):{},this.size=0},xt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},xt.prototype.get=function(t){var e=this.__data__;if(wt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return mt.call(e,t)?e[t]:void 0},xt.prototype.has=function(t){var e=this.__data__;return wt?void 0!==e[t]:Ot.call(e,t)},xt.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=wt&&void 0===e?"__lodash_hash_undefined__":e,this};var zt=Array.prototype.splice;function $t(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$t.prototype.clear=function(){this.__data__=[],this.size=0},$t.prototype.delete=function(t){var e=this.__data__,r=At(e,t);return!(r<0)&&(r==e.length-1?e.pop():zt.call(e,r,1),--this.size,!0)},$t.prototype.get=function(t){var e=this.__data__,r=At(e,t);return r<0?void 0:e[r][1]},$t.prototype.has=function(t){return At(this.__data__,t)>-1},$t.prototype.set=function(t,e){var r=this.__data__,n=At(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Bt=jt(f,"Map");function Pt(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function kt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}kt.prototype.clear=function(){this.size=0,this.__data__={hash:new xt,map:new(Bt||$t),string:new xt}},kt.prototype.delete=function(t){var e=Pt(this,t).delete(t);return this.size-=e?1:0,e},kt.prototype.get=function(t){return Pt(this,t).get(t)},kt.prototype.has=function(t){return Pt(this,t).has(t)},kt.prototype.set=function(t,e){var r=Pt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function Ft(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(Ft.Cache||kt),r}Ft.Cache=kt;var Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ct=/\\(\\)?/g,Et=function(t){var e=Ft(t,function(t){return 500===r.size&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Rt,function(t,r,n,o){e.push(n?o.replace(Ct,"$1"):r||t)}),e}),Mt=Et;function Tt(t,e){return E(t)?t:function(t,e){if(E(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!j(t))||ut.test(t)||!it.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:Mt(N(t))}function It(t){if("string"==typeof t||j(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Nt(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=Tt(e,t)).length;null!=t&&r<n;)t=t[It(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function Ut(t){return"[object Array]"===Object.prototype.toString.call(t)}function Dt(t){if(function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)){for(let e in t)return!1;return!0}return!1}function Ht(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!Dt(t)||(!!function(t){return!(!B(t)||""!==t)}(t)||(!!function(t){return!!Ut(t)&&0===t.length}(t)||!!k(t)))))}function Lt(t){return!0===(e=t)||!1===e||_(e)&&"[object Boolean]"==g(e);var e}function qt(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function Vt(t){if(!C(t))return!1;return q(t)>=0}function Wt(t,e){return P(t)&&Vt(e)?0===(e=q(e))?"":t.substring(0,e):""}function Gt(t,e){if(!P(t))return"";if(!Vt(e))return"";if(0===(e=q(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}function Jt(t){var e=this.__data__=new $t(t);this.size=e.size}Jt.prototype.clear=function(){this.__data__=new $t,this.size=0},Jt.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Jt.prototype.get=function(t){return this.__data__.get(t)},Jt.prototype.has=function(t){return this.__data__.has(t)},Jt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof $t){var n=r.__data__;if(!Bt||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new kt(n)}return r.set(t,e),this.size=r.size,this};function Kt(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new kt;++e<r;)this.add(t[e])}function Qt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}Kt.prototype.add=Kt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Kt.prototype.has=function(t){return this.__data__.has(t)};function Xt(t,e,r,n,o,i){var u=1&r,c=t.length,a=e.length;if(c!=a&&!(u&&a>c))return!1;var s=i.get(t),f=i.get(e);if(s&&f)return s==e&&f==t;var l=-1,p=!0,h=2&r?new Kt:void 0;for(i.set(t,e),i.set(e,t);++l<c;){var d=t[l],y=e[l];if(n)var v=u?n(y,d,l,e,t,i):n(d,y,l,t,e,i);if(void 0!==v){if(v)continue;p=!1;break}if(h){if(!Qt(e,function(t,e){if(u=e,!h.has(u)&&(d===t||o(d,t,r,n,i)))return h.push(e);var u})){p=!1;break}}else if(d!==y&&!o(d,y,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var Yt=f.Uint8Array;function Zt(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function te(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var ee=l?l.prototype:void 0,re=ee?ee.valueOf:void 0;var ne=Object.prototype.propertyIsEnumerable,oe=Object.getOwnPropertySymbols,ie=oe?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(oe(t),function(e){return ne.call(t,e)}))}:function(){return[]};function ue(t){return _(t)&&"[object Arguments]"==g(t)}var ce=Object.prototype,ae=ce.hasOwnProperty,se=ce.propertyIsEnumerable,fe=ue(function(){return arguments}())?ue:function(t){return _(t)&&ae.call(t,"callee")&&!se.call(t,"callee")},le=fe;var pe="object"==typeof exports&&exports&&!exports.nodeType&&exports,he=pe&&"object"==typeof module&&module&&!module.nodeType&&module,de=he&&he.exports===pe?f.Buffer:void 0,ye=(de?de.isBuffer:void 0)||function(){return!1},ve=/^(?:0|[1-9]\d*)$/;function be(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&ve.test(t))&&t>-1&&t%1==0&&t<e}function ge(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var _e={};_e["[object Float32Array]"]=_e["[object Float64Array]"]=_e["[object Int8Array]"]=_e["[object Int16Array]"]=_e["[object Int32Array]"]=_e["[object Uint8Array]"]=_e["[object Uint8ClampedArray]"]=_e["[object Uint16Array]"]=_e["[object Uint32Array]"]=!0,_e["[object Arguments]"]=_e["[object Array]"]=_e["[object ArrayBuffer]"]=_e["[object Boolean]"]=_e["[object DataView]"]=_e["[object Date]"]=_e["[object Error]"]=_e["[object Function]"]=_e["[object Map]"]=_e["[object Number]"]=_e["[object Object]"]=_e["[object RegExp]"]=_e["[object Set]"]=_e["[object String]"]=_e["[object WeakMap]"]=!1;var je="object"==typeof exports&&exports&&!exports.nodeType&&exports,we=je&&"object"==typeof module&&module&&!module.nodeType&&module,me=we&&we.exports===je&&a.process,Oe=function(){try{var t=we&&we.require&&we.require("util").types;return t||me&&me.binding&&me.binding("util")}catch(t){}}(),xe=Oe&&Oe.isTypedArray,Se=xe?function(t){return function(e){return t(e)}}(xe):function(t){return _(t)&&ge(t.length)&&!!_e[g(t)]},Ae=Se,ze=Object.prototype.hasOwnProperty;function $e(t,e){var r=E(t),n=!r&&le(t),o=!r&&!n&&ye(t),i=!r&&!n&&!o&&Ae(t),u=r||n||o||i,c=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],a=c.length;for(var s in t)!e&&!ze.call(t,s)||u&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||be(s,a))||c.push(s);return c}var Be=Object.prototype;var Pe=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),ke=Pe,Fe=Object.prototype.hasOwnProperty;function Re(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Be))return ke(t);var e,r,n=[];for(var o in Object(t))Fe.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Ce(t){return null!=(e=t)&&ge(e.length)&&!ct(e)?$e(t):Re(t);var e}function Ee(t){return function(t,e,r){var n=e(t);return E(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Ce,ie)}var Me=Object.prototype.hasOwnProperty;var Te=jt(f,"DataView"),Ie=jt(f,"Promise"),Ne=jt(f,"Set"),Ue=jt(f,"WeakMap"),De="[object Map]",He="[object Promise]",Le="[object Set]",qe="[object WeakMap]",Ve="[object DataView]",We=pt(Te),Ge=pt(Bt),Je=pt(Ie),Ke=pt(Ne),Qe=pt(Ue),Xe=g;(Te&&Xe(new Te(new ArrayBuffer(1)))!=Ve||Bt&&Xe(new Bt)!=De||Ie&&Xe(Ie.resolve())!=He||Ne&&Xe(new Ne)!=Le||Ue&&Xe(new Ue)!=qe)&&(Xe=function(t){var e=g(t),r="[object Object]"==e?t.constructor:void 0,n=r?pt(r):"";if(n)switch(n){case We:return Ve;case Ge:return De;case Je:return He;case Ke:return Le;case Qe:return qe}return e});var Ye=Xe,Ze="[object Arguments]",tr="[object Array]",er="[object Object]",rr=Object.prototype.hasOwnProperty;function nr(t,e,r,n,o,i){var u=E(t),c=E(e),a=u?tr:Ye(t),s=c?tr:Ye(e),f=(a=a==Ze?er:a)==er,l=(s=s==Ze?er:s)==er,p=a==s;if(p&&ye(t)){if(!ye(e))return!1;u=!0,f=!1}if(p&&!f)return i||(i=new Jt),u||Ae(t)?Xt(t,e,r,n,o,i):function(t,e,r,n,o,i,u){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new Yt(t),new Yt(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return St(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=Zt;case"[object Set]":var a=1&n;if(c||(c=te),t.size!=e.size&&!a)return!1;var s=u.get(t);if(s)return s==e;n|=2,u.set(t,e);var f=Xt(c(t),c(e),n,o,i,u);return u.delete(t),f;case"[object Symbol]":if(re)return re.call(t)==re.call(e)}return!1}(t,e,a,r,n,o,i);if(!(1&r)){var h=f&&rr.call(t,"__wrapped__"),d=l&&rr.call(e,"__wrapped__");if(h||d){var y=h?t.value():t,v=d?e.value():e;return i||(i=new Jt),o(y,v,r,n,i)}}return!!p&&(i||(i=new Jt),function(t,e,r,n,o,i){var u=1&r,c=Ee(t),a=c.length;if(a!=Ee(e).length&&!u)return!1;for(var s=a;s--;){var f=c[s];if(!(u?f in e:Me.call(e,f)))return!1}var l=i.get(t),p=i.get(e);if(l&&p)return l==e&&p==t;var h=!0;i.set(t,e),i.set(e,t);for(var d=u;++s<a;){var y=t[f=c[s]],v=e[f];if(n)var b=u?n(v,y,f,e,t,i):n(y,v,f,t,e,i);if(!(void 0===b?y===v||o(y,v,r,n,i):b)){h=!1;break}d||(d="constructor"==f)}if(h&&!d){var g=t.constructor,_=e.constructor;g==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,o,i))}function or(t,e,r,n,o){return t===e||(null==t||null==e||!_(t)&&!_(e)?t!=t&&e!=e:nr(t,e,r,n,or,o))}function ir(t,e){return or(t,e)}function ur(t,e,n={}){if((!Ut(o=e)||0===o.length||1===o.length&&Ht(o[0]))&&!P(e))throw new Error("args is not an effective array or string");var o;P(e)&&(e=[e]);let i=Nt(n,"mode");"spawn"!==i&&"exec"!==i&&"execFile"!==i&&(i="spawn");let u=Nt(n,"cbStdout"),c=Nt(n,"cbStderr"),a=Nt(n,"codeCmd");P(a)||(a="utf8");let s=Nt(n,"useChcp");Lt(s)||(s=!1);let f=function(){let t,e,r=new Promise(function(){t=arguments[0],e=arguments[1]});return r.resolve=t,r.reject=e,r}();if(!function(t,e){function r(t){return Ut(t)?t:[t]}if(Ht(t))return!1;if(0===(t=r(t)).length)return!1;if(Ht(t))return!1;if(0===(e=r(e)).length)return!1;for(let r=0;r<t.length;r++)for(let n=0;n<e.length;n++)if(ir(t[r],e[n]))return!0;return!1}(i,["spawn","exec","execFile"]))return f.reject(`invalid mode[${i}]`),f;let l=null,p="";try{if("spawn"===i){let n=Wt(t,1),o=Gt(t,1);if('"'===n||'"'===o||"'"===n||"'"===o)throw new Error("prog of spawn doens not need to add quotes");l=r.spawn(t,e,{windowsHide:!0,shell:!1})}else if("exec"===i){let n="";s&&(n="cmd /c chcp 65001>nul &&"),l=r.exec(`${n} ${t} ${e.join(" ")} & exit`,{windowsHide:!0,encoding:a})}else"execFile"===i&&(l=r.execFile(t,e,{windowsHide:!0,encoding:a}))}catch(t){return f.reject(t),f}return l.stdout.on("data",t=>{let e="";e="spawn"===i?t.toString(a):t.toString(),p+=e+"\n",qt(u)&&u(e)}),l.stderr.on("data",t=>{let e="";e="spawn"===i?t.toString(a):t.toString(),p+=e+"\n",qt(c)&&c(e)}),l.on("close",t=>{0!==t?f.reject(`code[${t}]:\n${p}`):f.resolve(p)}),l.on("error",t=>{f.reject(t)}),f}function cr(t,e={}){let r=Nt(e,"fs");return!!r.existsSync(t)&&(!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink())}function ar(t){return cr(t,{fs:n})}function sr(t){return function(t,e={}){let r=Nt(e,"fs");if(!r.existsSync(t))return{success:"file does not exist: "+t};if(!cr(t,{fs:r}))return{error:"input path is not a file: "+t};try{r.unlinkSync(t)}catch(t){return{error:t}}return{success:"done: "+t}}(t,{fs:n})}function fr(t,e){return P(t)&&Vt(e)?0===(e=q(e))?t:Wt(t,t.length-e):""}function lr(t){if(!P(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===Gt(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===Gt(t,1)){let e=fr(t,1);return":"===Gt(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===Gt(t,1)){let e=fr(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}function pr(t){if(!P(t))return"";let e=lr(t);if(e.isRoot)return e.path;let r=function(t){if(!P(t))return"";let e=lr(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}(t=e.path);if(!P(r))return t;let n=lr(t=fr(t,r.length));return n.isRoot,n.path}function hr(t,e={}){let r=Nt(e,"fs");if(!r.existsSync(t))return!1;let n=r.lstatSync(t);return!n.isFile()&&!n.isSymbolicLink()}function dr(t,e,r={}){let n=Nt(r,"fs");if(!cr(t,{fs:n}))return{error:`pahOld[${t}] is not a file`};if(n.existsSync(e))return{error:`pahNew[${e}] already exists`};let o=pr(e);hr(o,{fs:n})||function(t,e={}){let r=Nt(e,"fs");if(hr(t,{fs:r}))return{success:"input folder is already exists: "+t};if(r.existsSync(t))return{error:"input path already exists: "+t};try{r.mkdirSync(t,{recursive:!0})}catch(t){return{error:t}}}(o,{fs:n});try{n.renameSync(t,e)}catch(t){return{error:t}}return{success:"done: "+e}}let yr=t.resolve();return async function(r,o,i={}){let u=null;if("win32"!==e.platform)return Promise.reject("operating system is not windows");if(!ar(r))return Promise.reject(`fpIn[${r}] does not exist`);let c="cv.exe",a="";{let t=`${yr}/src/`,e=`${yr}/node_modules/w-docx2pdf/src/`;if(ar(`${t}${c}`))a=t;else{if(!ar(`${e}${c}`))return Promise.reject("can not find folder for docx2pdf");a=e}}let s=`${a}${c}`,f=`./${G()}.pdf`;r=t.resolve(r),f=t.resolve(f);let l={fpIn:r,fpOut:f,opt:{}},p=function(t){if(!P(t))return"";let e=rt.parse(t);return ot.stringify(e)}(JSON.stringify(l));if(await ur(s,p).catch(t=>{console.log("execProcess catch",t),u=t.toString()}),u)return Promise.reject(u);if(!ar(f))return Promise.reject("can not convert");sr(o);let h=dr(f,o,{fs:n});return h.error?Promise.reject(h.error):"ok"}});
//# sourceMappingURL=w-docx-2-pdf.umd.js.map
