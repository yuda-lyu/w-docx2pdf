/*!
 * w-docx-2-pdf v1.0.3
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("process"),require("child_process"),require("fs")):"function"==typeof define&&define.amd?define(["path","process","child_process","fs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-docx-2-pdf"]=e(t.path,t.process,t.child_process,t.fs)}(this,function(t,e,r,n){"use strict";var i=Array.isArray,o="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,s=o||u||Function("return this")(),a=s.Symbol,c=Object.prototype,f=c.hasOwnProperty,l=c.toString,p=a?a.toStringTag:void 0;var h=Object.prototype.toString;var d=a?a.toStringTag:void 0;function y(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":d&&d in Object(t)?function(t){var e=f.call(t,p),r=t[p];try{t[p]=void 0;var n=!0}catch(t){}var i=l.call(t);return n&&(e?t[p]=r:delete t[p]),i}(t):function(t){return h.call(t)}(t)}function v(t){return null!=t&&"object"==typeof t}function b(t){return"symbol"==typeof t||v(t)&&"[object Symbol]"==y(t)}var g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_=/^\w*$/;function w(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function m(t){if(!w(t))return!1;var e=y(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var j,$=s["__core-js_shared__"],O=(j=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"";var S=Function.prototype.toString;function x(t){if(null!=t){try{return S.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var M=/^\[object .+?Constructor\]$/,A=Function.prototype,D=Object.prototype,z=A.toString,P=D.hasOwnProperty,k=RegExp("^"+z.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function B(t){return!(!w(t)||(e=t,O&&O in e))&&(m(t)?k:M).test(x(t));var e}function T(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return B(r)?r:void 0}var C=T(Object,"create");var F=Object.prototype.hasOwnProperty;var H=Object.prototype.hasOwnProperty;function E(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function L(t,e){return t===e||t!=t&&e!=e}function I(t,e){for(var r=t.length;r--;)if(L(t[r][0],e))return r;return-1}E.prototype.clear=function(){this.__data__=C?C(null):{},this.size=0},E.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},E.prototype.get=function(t){var e=this.__data__;if(C){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return F.call(e,t)?e[t]:void 0},E.prototype.has=function(t){var e=this.__data__;return C?void 0!==e[t]:H.call(e,t)},E.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=C&&void 0===e?"__lodash_hash_undefined__":e,this};var N=Array.prototype.splice;function U(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}U.prototype.clear=function(){this.__data__=[],this.size=0},U.prototype.delete=function(t){var e=this.__data__,r=I(e,t);return!(r<0)&&(r==e.length-1?e.pop():N.call(e,r,1),--this.size,!0)},U.prototype.get=function(t){var e=this.__data__,r=I(e,t);return r<0?void 0:e[r][1]},U.prototype.has=function(t){return I(this.__data__,t)>-1},U.prototype.set=function(t,e){var r=this.__data__,n=I(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Y=T(s,"Map");function W(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function R(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}R.prototype.clear=function(){this.size=0,this.__data__={hash:new E,map:new(Y||U),string:new E}},R.prototype.delete=function(t){var e=W(this,t).delete(t);return this.size-=e?1:0,e},R.prototype.get=function(t){return W(this,t).get(t)},R.prototype.has=function(t){return W(this,t).has(t)},R.prototype.set=function(t,e){var r=W(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function V(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var u=t.apply(this,n);return r.cache=o.set(i,u)||o,u};return r.cache=new(V.Cache||R),r}V.Cache=R;var q,J,Z,G=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Q=/\\(\\)?/g,K=(q=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(G,function(t,r,n,i){e.push(n?i.replace(Q,"$1"):r||t)}),e},J=V(q,function(t){return 500===Z.size&&Z.clear(),t}),Z=J.cache,J),X=K;var tt=a?a.prototype:void 0,et=tt?tt.toString:void 0;function rt(t){if("string"==typeof t)return t;if(i(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}(t,rt)+"";if(b(t))return et?et.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function nt(t){return null==t?"":rt(t)}function it(t,e){return i(t)?t:function(t,e){if(i(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!b(t))||_.test(t)||!g.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:X(nt(t))}function ot(t){if("string"==typeof t||b(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ut(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=it(e,t)).length;null!=t&&r<n;)t=t[ot(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function st(t){return"[object String]"===Object.prototype.toString.call(t)}function at(t){return!(!st(t)||""===t)}var ct=/\s/;var ft=/^\s+/;function lt(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&ct.test(t.charAt(e)););return e}(t)+1).replace(ft,""):t}var pt=/^[-+]0x[0-9a-f]+$/i,ht=/^0b[01]+$/i,dt=/^0o[0-7]+$/i,yt=parseInt;function vt(t){if("number"==typeof t)return t;if(b(t))return NaN;if(w(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=w(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=lt(t);var r=ht.test(t);return r||dt.test(t)?yt(t.slice(2),r?2:8):pt.test(t)?NaN:+t}var bt=1/0;function gt(t){return t?(t=vt(t))===bt||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function _t(t){var e=gt(t),r=e%1;return e==e?r?e-r:e:0}function wt(t){return t!=t}function mt(t){let e=!1;if(at(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(wt(t))return!1;e=!0}return e}function jt(t){if(!mt(t))return 0;return gt(t)}function $t(t){return!!mt(t)&&(t=jt(t),"number"==typeof(e=t)&&e==_t(e));var e}var Ot=s.isFinite,St=Math.min;var xt=function(t){var e=Math[t];return function(t,r){if(t=vt(t),(r=null==r?0:St(_t(r),292))&&Ot(t)){var n=(nt(t)+"e").split("e");return+((n=(nt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),Mt=xt;function At(t){if(!mt(t))return 0;t=jt(t);let e=Mt(t);return"0"===String(e)?0:e}let Dt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),zt=Dt.length;function Pt(t=32){let e=[];var r;t=$t(r=t)&&At(r)>0?At(t):32;for(let r=0;r<t;r++)e[r]=Dt[0|Math.random()*zt];return e.join("")}var kt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Bt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Tt(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var r=function t(){if(this instanceof t){var r=[null];return r.push.apply(r,arguments),new(Function.bind.apply(e,r))}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}var Ct={exports:{}};!function(t){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",i="second",o="minute",u="hour",s="day",a="week",c="month",f="quarter",l="year",p="date",h="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),i=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(i,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),i=e.clone().add(n,c),o=r-i<0,u=e.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:l,w:a,d:s,D:p,h:u,m:o,s:i,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},_="en",w={};w[_]=v;var m="$isDayjsObject",j=function(t){return t instanceof x||!(!t||!t[m])},$=function t(e,r,n){var i;if(!e)return _;if("string"==typeof e){var o=e.toLowerCase();w[o]&&(i=o),r&&(w[o]=r,i=o);var u=e.split("-");if(!i&&u.length>1)return t(u[0])}else{var s=e.name;w[s]=e,i=s}return!n&&i&&(_=i),i||!n&&_},O=function(t,e){if(j(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new x(r)},S=g;S.l=$,S.i=j,S.w=function(t,e){return O(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var x=function(){function v(t){this.$L=$(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[m]=!0}var b=v.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(S.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(e)}(t),this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return S},b.isValid=function(){return!(this.$d.toString()===h)},b.isSame=function(t,e){var r=O(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return O(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<O(t)},b.$g=function(t,e,r){return S.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!S.u(e)||e,f=S.p(t),h=function(t,e){var i=S.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?i:i.endOf(s)},d=function(t,e){return S.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},y=this.$W,v=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?h(1,0):h(31,11);case c:return n?h(1,v):h(0,v+1);case a:var _=this.$locale().weekStart||0,w=(y<_?y+7:y)-_;return h(n?b-w:b+(6-w),v);case s:case p:return d(g+"Hours",0);case u:return d(g+"Minutes",1);case o:return d(g+"Seconds",2);case i:return d(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,a=S.p(t),f="set"+(this.$u?"UTC":""),h=(r={},r[s]=f+"Date",r[p]=f+"Date",r[c]=f+"Month",r[l]=f+"FullYear",r[u]=f+"Hours",r[o]=f+"Minutes",r[i]=f+"Seconds",r[n]=f+"Milliseconds",r)[a],d=a===s?this.$D+(e-this.$W):e;if(a===c||a===l){var y=this.clone().set(p,1);y.$d[h](d),y.init(),this.$d=y.set(p,Math.min(this.$D,y.daysInMonth())).$d}else h&&this.$d[h](d);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[S.p(t)]()},b.add=function(n,f){var p,h=this;n=Number(n);var d=S.p(f),y=function(t){var e=O(h);return S.w(e.date(e.date()+Math.round(t*n)),h)};if(d===c)return this.set(c,this.$M+n);if(d===l)return this.set(l,this.$y+n);if(d===s)return y(1);if(d===a)return y(7);var v=(p={},p[o]=e,p[u]=r,p[i]=t,p)[d]||1,b=this.$d.getTime()+n*v;return S.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||h;var n=t||"YYYY-MM-DDTHH:mm:ssZ",i=S.z(this),o=this.$H,u=this.$m,s=this.$M,a=r.weekdays,c=r.months,f=r.meridiem,l=function(t,r,i,o){return t&&(t[r]||t(e,n))||i[r].slice(0,o)},p=function(t){return S.s(o%12||12,t,"0")},d=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(y,function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return S.s(e.$y,4,"0");case"M":return s+1;case"MM":return S.s(s+1,2,"0");case"MMM":return l(r.monthsShort,s,c,3);case"MMMM":return l(c,s);case"D":return e.$D;case"DD":return S.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,a,2);case"ddd":return l(r.weekdaysShort,e.$W,a,3);case"dddd":return a[e.$W];case"H":return String(o);case"HH":return S.s(o,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return d(o,u,!0);case"A":return d(o,u,!1);case"m":return String(u);case"mm":return S.s(u,2,"0");case"s":return String(e.$s);case"ss":return S.s(e.$s,2,"0");case"SSS":return S.s(e.$ms,3,"0");case"Z":return i}return null}(t)||i.replace(":","")})},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,p,h){var d,y=this,v=S.p(p),b=O(n),g=(b.utcOffset()-this.utcOffset())*e,_=this-b,w=function(){return S.m(y,b)};switch(v){case l:d=w()/12;break;case c:d=w();break;case f:d=w()/3;break;case a:d=(_-g)/6048e5;break;case s:d=(_-g)/864e5;break;case u:d=_/r;break;case o:d=_/e;break;case i:d=_/t;break;default:d=_}return h?d:S.a(d)},b.daysInMonth=function(){return this.endOf(c).$D},b.$locale=function(){return w[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=$(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return S.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},v}(),M=x.prototype;return O.prototype=M,[["$ms",n],["$s",i],["$m",o],["$H",u],["$W",s],["$M",c],["$y",l],["$D",p]].forEach(function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),O.extend=function(t,e){return t.$i||(t(e,x,O),t.$i=!0),O},O.locale=$,O.isDayjs=j,O.unix=function(t){return O(1e3*t)},O.en=w[_],O.Ls=w,O.p={},O}()}(Ct);var Ft=Bt(Ct.exports);function Ht(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var Et={exports:{}};var Lt,It={exports:{}},Nt=Tt(Object.freeze({__proto__:null,default:{}}));function Ut(){return Lt||(Lt=1,function(t){var e;t.exports=(e=e||function(t,e){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&void 0!==kt&&kt.crypto&&(r=kt.crypto),!r)try{r=Nt}catch(t){}var n=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function t(){}return function(e){var r;return t.prototype=e,r=new t,t.prototype=null,r}}(),o={},u=o.lib={},s=u.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},a=u.WordArray=s.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||f).stringify(this)},concat:function(t){var e=this.words,r=t.words,n=this.sigBytes,i=t.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var u=r[o>>>2]>>>24-o%4*8&255;e[n+o>>>2]|=u<<24-(n+o)%4*8}else for(var s=0;s<i;s+=4)e[n+s>>>2]=r[s>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-r%4*8,e.length=t.ceil(r/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4)e.push(n());return new a.init(e,t)}}),c=o.enc={},f=c.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],i=0;i<r;i++){var o=e[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n+=2)r[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new a.init(r,e/2)}},l=c.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,n=[],i=0;i<r;i++){var o=e[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new a.init(r,e)}},p=c.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=u.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r,n=this._data,i=n.words,o=n.sigBytes,u=this.blockSize,s=o/(4*u),c=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*u,f=t.min(4*c,o);if(c){for(var l=0;l<c;l+=u)this._doProcessBlock(i,l);r=i.splice(0,c),n.sigBytes-=f}return new a.init(r,f)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});u.Hasher=h.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new d.HMAC.init(t,r).finalize(e)}}});var d=o.algo={};return o}(Math),e)}(It)),It.exports}!function(t){t.exports=Ut().enc.Utf8}(Et);var Yt=Bt(Et.exports),Wt={exports:{}};!function(t){var e;t.exports=(e=Ut(),function(){var t=e,r=t.lib.WordArray;function n(t,e,n){for(var i=[],o=0,u=0;u<e;u++)if(u%4){var s=n[t.charCodeAt(u-1)]<<u%4*2|n[t.charCodeAt(u)]>>>6-u%4*2;i[o>>>2]|=s<<24-o%4*8,o++}return r.create(i,o)}t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,n=this._map;t.clamp();for(var i=[],o=0;o<r;o+=3)for(var u=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<r;s++)i.push(n.charAt(u>>>6*(3-s)&63));var a=n.charAt(64);if(a)for(;i.length%4;)i.push(a);return i.join("")},parse:function(t){var e=t.length,r=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<r.length;o++)i[r.charCodeAt(o)]=o}var u=r.charAt(64);if(u){var s=t.indexOf(u);-1!==s&&(e=s)}return n(t,e,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64)}(Wt);var Rt=Bt(Wt.exports);function Vt(t){return"[object Array]"===Object.prototype.toString.call(t)}function qt(t){if(function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)){for(let e in t)return!1;return!0}return!1}function Jt(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!qt(t)||(!!function(t){return!(!st(t)||""!==t)}(t)||(!!function(t){return!!Vt(t)&&0===t.length}(t)||!!wt(t)))))}function Zt(t){return!0===(e=t)||!1===e||v(e)&&"[object Boolean]"==y(e);var e}function Gt(t){if(!$t(t))return!1;return At(t)>=0}function Qt(t){var e=this.__data__=new U(t);this.size=e.size}Qt.prototype.clear=function(){this.__data__=new U,this.size=0},Qt.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Qt.prototype.get=function(t){return this.__data__.get(t)},Qt.prototype.has=function(t){return this.__data__.has(t)},Qt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof U){var n=r.__data__;if(!Y||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new R(n)}return r.set(t,e),this.size=r.size,this};function Kt(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new R;++e<r;)this.add(t[e])}function Xt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function te(t,e){return t.has(e)}Kt.prototype.add=Kt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Kt.prototype.has=function(t){return this.__data__.has(t)};function ee(t,e,r,n,i,o){var u=1&r,s=t.length,a=e.length;if(s!=a&&!(u&&a>s))return!1;var c=o.get(t),f=o.get(e);if(c&&f)return c==e&&f==t;var l=-1,p=!0,h=2&r?new Kt:void 0;for(o.set(t,e),o.set(e,t);++l<s;){var d=t[l],y=e[l];if(n)var v=u?n(y,d,l,e,t,o):n(d,y,l,t,e,o);if(void 0!==v){if(v)continue;p=!1;break}if(h){if(!Xt(e,function(t,e){if(!te(h,e)&&(d===t||i(d,t,r,n,o)))return h.push(e)})){p=!1;break}}else if(d!==y&&!i(d,y,r,n,o)){p=!1;break}}return o.delete(t),o.delete(e),p}var re=s.Uint8Array;function ne(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function ie(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var oe=a?a.prototype:void 0,ue=oe?oe.valueOf:void 0;var se=Object.prototype.propertyIsEnumerable,ae=Object.getOwnPropertySymbols,ce=ae?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var u=t[r];e(u,r,t)&&(o[i++]=u)}return o}(ae(t),function(e){return se.call(t,e)}))}:function(){return[]},fe=ce;function le(t){return v(t)&&"[object Arguments]"==y(t)}var pe=Object.prototype,he=pe.hasOwnProperty,de=pe.propertyIsEnumerable,ye=le(function(){return arguments}())?le:function(t){return v(t)&&he.call(t,"callee")&&!de.call(t,"callee")},ve=ye;var be="object"==typeof exports&&exports&&!exports.nodeType&&exports,ge=be&&"object"==typeof module&&module&&!module.nodeType&&module,_e=ge&&ge.exports===be?s.Buffer:void 0,we=(_e?_e.isBuffer:void 0)||function(){return!1},me=/^(?:0|[1-9]\d*)$/;function je(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&me.test(t))&&t>-1&&t%1==0&&t<e}function $e(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var Oe={};Oe["[object Float32Array]"]=Oe["[object Float64Array]"]=Oe["[object Int8Array]"]=Oe["[object Int16Array]"]=Oe["[object Int32Array]"]=Oe["[object Uint8Array]"]=Oe["[object Uint8ClampedArray]"]=Oe["[object Uint16Array]"]=Oe["[object Uint32Array]"]=!0,Oe["[object Arguments]"]=Oe["[object Array]"]=Oe["[object ArrayBuffer]"]=Oe["[object Boolean]"]=Oe["[object DataView]"]=Oe["[object Date]"]=Oe["[object Error]"]=Oe["[object Function]"]=Oe["[object Map]"]=Oe["[object Number]"]=Oe["[object Object]"]=Oe["[object RegExp]"]=Oe["[object Set]"]=Oe["[object String]"]=Oe["[object WeakMap]"]=!1;var Se="object"==typeof exports&&exports&&!exports.nodeType&&exports,xe=Se&&"object"==typeof module&&module&&!module.nodeType&&module,Me=xe&&xe.exports===Se&&o.process,Ae=function(){try{var t=xe&&xe.require&&xe.require("util").types;return t||Me&&Me.binding&&Me.binding("util")}catch(t){}}(),De=Ae&&Ae.isTypedArray,ze=De?function(t){return function(e){return t(e)}}(De):function(t){return v(t)&&$e(t.length)&&!!Oe[y(t)]},Pe=ze,ke=Object.prototype.hasOwnProperty;function Be(t,e){var r=i(t),n=!r&&ve(t),o=!r&&!n&&we(t),u=!r&&!n&&!o&&Pe(t),s=r||n||o||u,a=s?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=a.length;for(var f in t)!e&&!ke.call(t,f)||s&&("length"==f||o&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||je(f,c))||a.push(f);return a}var Te=Object.prototype;var Ce=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Fe=Ce,He=Object.prototype.hasOwnProperty;function Ee(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Te))return Fe(t);var e,r,n=[];for(var i in Object(t))He.call(t,i)&&"constructor"!=i&&n.push(i);return n}function Le(t){return null!=(e=t)&&$e(e.length)&&!m(e)?Be(t):Ee(t);var e}function Ie(t){return function(t,e,r){var n=e(t);return i(t)?n:function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}(n,r(t))}(t,Le,fe)}var Ne=Object.prototype.hasOwnProperty;var Ue=T(s,"DataView"),Ye=T(s,"Promise"),We=T(s,"Set"),Re=T(s,"WeakMap"),Ve="[object Map]",qe="[object Promise]",Je="[object Set]",Ze="[object WeakMap]",Ge="[object DataView]",Qe=x(Ue),Ke=x(Y),Xe=x(Ye),tr=x(We),er=x(Re),rr=y;(Ue&&rr(new Ue(new ArrayBuffer(1)))!=Ge||Y&&rr(new Y)!=Ve||Ye&&rr(Ye.resolve())!=qe||We&&rr(new We)!=Je||Re&&rr(new Re)!=Ze)&&(rr=function(t){var e=y(t),r="[object Object]"==e?t.constructor:void 0,n=r?x(r):"";if(n)switch(n){case Qe:return Ge;case Ke:return Ve;case Xe:return qe;case tr:return Je;case er:return Ze}return e});var nr=rr,ir="[object Arguments]",or="[object Array]",ur="[object Object]",sr=Object.prototype.hasOwnProperty;function ar(t,e,r,n,o,u){var s=i(t),a=i(e),c=s?or:nr(t),f=a?or:nr(e),l=(c=c==ir?ur:c)==ur,p=(f=f==ir?ur:f)==ur,h=c==f;if(h&&we(t)){if(!we(e))return!1;s=!0,l=!1}if(h&&!l)return u||(u=new Qt),s||Pe(t)?ee(t,e,r,n,o,u):function(t,e,r,n,i,o,u){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new re(t),new re(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return L(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=ne;case"[object Set]":var a=1&n;if(s||(s=ie),t.size!=e.size&&!a)return!1;var c=u.get(t);if(c)return c==e;n|=2,u.set(t,e);var f=ee(s(t),s(e),n,i,o,u);return u.delete(t),f;case"[object Symbol]":if(ue)return ue.call(t)==ue.call(e)}return!1}(t,e,c,r,n,o,u);if(!(1&r)){var d=l&&sr.call(t,"__wrapped__"),y=p&&sr.call(e,"__wrapped__");if(d||y){var v=d?t.value():t,b=y?e.value():e;return u||(u=new Qt),o(v,b,r,n,u)}}return!!h&&(u||(u=new Qt),function(t,e,r,n,i,o){var u=1&r,s=Ie(t),a=s.length;if(a!=Ie(e).length&&!u)return!1;for(var c=a;c--;){var f=s[c];if(!(u?f in e:Ne.call(e,f)))return!1}var l=o.get(t),p=o.get(e);if(l&&p)return l==e&&p==t;var h=!0;o.set(t,e),o.set(e,t);for(var d=u;++c<a;){var y=t[f=s[c]],v=e[f];if(n)var b=u?n(v,y,f,e,t,o):n(y,v,f,t,e,o);if(!(void 0===b?y===v||i(y,v,r,n,o):b)){h=!1;break}d||(d="constructor"==f)}if(h&&!d){var g=t.constructor,_=e.constructor;g==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _||(h=!1)}return o.delete(t),o.delete(e),h}(t,e,r,n,o,u))}function cr(t,e,r,n,i){return t===e||(null==t||null==e||!v(t)&&!v(e)?t!=t&&e!=e:ar(t,e,r,n,cr,i))}function fr(t,e){return cr(t,e)}function lr(t,e,n={}){if((!Vt(i=e)||0===i.length||1===i.length&&Jt(i[0]))&&!at(e))throw new Error("args is not an effective array or string");var i;at(e)&&(e=[e]);let o=ut(n,"mode");"spawn"!==o&&"exec"!==o&&"execFile"!==o&&(o="spawn");let u=ut(n,"cbStdout"),s=ut(n,"cbStderr"),a=ut(n,"codeCmd");at(a)||(a="utf8");let c=ut(n,"useChcp");Zt(c)||(c=!1);let f=function(){let t,e,r=new Promise(function(){t=arguments[0],e=arguments[1]});return r.resolve=t,r.reject=e,r}();if(!function(t,e){function r(t){return Vt(t)?t:[t]}if(Jt(t))return!1;if(0===(t=r(t)).length)return!1;if(Jt(t))return!1;if(0===(e=r(e)).length)return!1;for(let r=0;r<t.length;r++)for(let n=0;n<e.length;n++)if(fr(t[r],e[n]))return!0;return!1}(o,["spawn","exec","execFile"]))return f.reject(`invalid mode[${o}]`),f;let l=null,p="";try{if("spawn"===o){let n=(d=1,at(h=t)&&Gt(d)?0===(d=At(d))?"":h.substring(0,d):""),i=function(t,e){if(!at(t))return"";if(!Gt(e))return"";if(0===(e=At(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}(t,1);if('"'===n||'"'===i||"'"===n||"'"===i)throw new Error("prog of spawn doens not need to add quotes");l=r.spawn(t,e,{windowsHide:!0,shell:!1})}else if("exec"===o){let n="";c&&(n="cmd /c chcp 65001>nul &&"),l=r.exec(`${n} ${t} ${e.join(" ")} & exit`,{windowsHide:!0,encoding:a})}else"execFile"===o&&(l=r.execFile(t,e,{windowsHide:!0,encoding:a}))}catch(t){return f.reject(t),f}var h,d;return l.stdout.on("data",t=>{let e="";e="spawn"===o?t.toString(a):t.toString(),p+=e+"\n",Ht(u)&&u(e)}),l.stderr.on("data",t=>{let e="";e="spawn"===o?t.toString(a):t.toString(),p+=e+"\n",Ht(s)&&s(e)}),l.on("close",t=>{0!==t?f.reject(`code[${t}]:\n${p}`):f.resolve(p)}),l.on("error",t=>{f.reject(t)}),f}function pr(t,e={}){let r=ut(e,"fs");return!!r.existsSync(t)&&(!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink())}function hr(t){return pr(t,{fs:n})}function dr(t,e={}){let r=ut(e,"fs");if(!r.existsSync(t))return!1;let n=r.lstatSync(t);return!n.isFile()&&!n.isSymbolicLink()}function yr(t,e={}){let r=ut(e,"fs");if(dr(t,{fs:r}))return{success:"input folder is already exists: "+t};if(r.existsSync(t))return{error:"input path already exists: "+t};try{r.mkdirSync(t,{recursive:!0})}catch(t){return{error:t}}return{success:"done: "+t}}function vr(t,e,r={}){let n=ut(r,"path"),i=ut(r,"fs"),o=ut(r,"useSync","");Zt(o)||(o=!0);let u="";return u=o?function(t,e,r={}){let n=ut(r,"path"),i=ut(r,"fs");if(!pr(t,{fs:i}))return{error:`fpSrc[${t}] is not a file`};try{yr(n.dirname(e),{fs:i}),i.copyFileSync(t,e)}catch(t){return{error:t}}return{success:"done: "+e}}(t,e,{path:n,fs:i}):async function(t,e,r={}){let n=ut(r,"path"),i=ut(r,"fs");if(!pr(t,{fs:i}))return{error:`fpSrc[${t}] is not a file`};let o=null;return await(async(t,e)=>{yr(n.dirname(e),{fs:i}),await new Promise((r,n)=>{let o=i.createReadStream(t),u=i.createWriteStream(e);o.on("error",n),u.on("error",n),u.on("finish",r),o.pipe(u)})})(t,e).then(()=>{o={success:"done: "+e}}).catch(t=>{o={error:t}}),o}(t,e,{path:n,fs:i}),u}function br(e,r,i={}){return vr(e,r,{path:t,fs:n,...i})}function gr(t){return function(t,e={}){let r=ut(e,"fs");if(!r.existsSync(t))return{success:"file does not exist: "+t};if(!pr(t,{fs:r}))return{error:"input path is not a file: "+t};try{r.unlinkSync(t)}catch(t){return{error:t}}return{success:"done: "+t}}(t,{fs:n})}let _r=t.resolve();return async function(r,i,o={}){let u=null;if("win32"!==e.platform)return Promise.reject("operating system is not windows");if(!hr(r))return Promise.reject(`fpIn[${r}] does not exist`);let s=ut(o,"mode","");"MicrosoftOffice"!==s&&"LibreOffice"!==s&&(s="MicrosoftOffice");let a=ut(o,"fpExeLibreOffice","");hr(a)||(a="C:\\Program Files\\LibreOffice\\program\\soffice.exe");let c=ut(o,"fdTemp");at(c)||(c="./_convertTempPdf"),dr(c,{fs:n})||function(t){yr(t,{fs:n})}(c),r=t.resolve(r);let f=`${function(){if(!Ht(Ft))throw new Error("invalid dayjs");return Ft().format("YYYYMMDDHHmmss")}()}_${Pt(6)}`,l=`${c}/${`docx2pdf_${f}.docx`}`;l=t.resolve(l),br(r,l);let p=`${c}/${`docx2pdf_${f}.pdf`}`;if(p=t.resolve(p),"MicrosoftOffice"===s){let t="cv.exe",e="";{let r=`${_r}/src/`,n=`${_r}/node_modules/w-docx2pdf/src/`;if(hr(`${r}${t}`))e=r;else{if(!hr(`${n}${t}`))return Promise.reject("can not find folder for docx2pdf");e=n}}let r=`${e}${t}`,n={fpIn:l,fpOut:p,opt:{}},i=function(t){if(!at(t))return"";let e=Yt.parse(t);return Rt.stringify(e)}(JSON.stringify(n));if(await lr(r,i).catch(t=>{console.log("execProcess catch",t),u=t.toString()}),u)return Promise.reject(u)}else if("LibreOffice"===s){let t=a,e=["--headless","--norestore","--invisible","--convert-to","pdf:writer_pdf_Export","--outdir",c,l];if(await lr(t,e).catch(t=>{console.log("execProcess catch",t),u=t.toString()}),u)return Promise.reject(u)}if(!hr(p))return Promise.reject("can not convert");gr(i);let h=br(p,i);return h.error?Promise.reject(h.error):(gr(l),gr(p),"ok")}});
//# sourceMappingURL=w-docx-2-pdf.umd.js.map
